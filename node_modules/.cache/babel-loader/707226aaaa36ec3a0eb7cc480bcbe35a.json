{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Sergey\\\\Desktop\\\\Messenger\\\\src\\\\hooks\\\\useAuth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport { useState, useEffect, useContext, createContext } from 'react';\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'firebase/auth';\nimport { auth } from '../firebase';\nimport { useDB } from './useDB';\nimport { getDB } from './useDB';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport function AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const authData = useProvideAuth();\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: authData,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AuthProvider, \"cscIlfKsRMD8Yvphp0atcYvNBW4=\", false, function () {\n  return [useProvideAuth];\n});\n\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n\n  return useContext(AuthContext);\n};\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nfunction useProvideAuth() {\n  _s3();\n\n  const [user, setUser] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const {\n    setDocument\n  } = useDB();\n  const {\n    getDocument\n  } = useDB();\n\n  function signin(email, password) {\n    setLoading(true);\n    signInWithEmailAndPassword(auth, email, password).then(userCredential => {\n      console.log('signIn userCredential >>>', userCredential);\n      setUser(userCredential.user);\n      setError(false);\n    }).catch(error => {\n      console.warn('signIn error >>>', error);\n      setError({\n        code: error.code,\n        message: error.message\n      });\n      setUser(false);\n    }).finally(() => setLoading(false));\n  }\n\n  function signup(_ref2) {\n    let {\n      email,\n      password,\n      nickname\n    } = _ref2;\n    setLoading(true);\n    createUserWithEmailAndPassword(auth, email, password).then(userCredential => {\n      console.log('signUp userCredential >>>', userCredential);\n      const newUser = {\n        nickname,\n        email,\n        createdAt: Date.now(),\n        friends: [],\n        uid: userCredential.user.uid\n      };\n      setDocument('users', newUser, userCredential.user.uid);\n      setUser(newUser);\n      setError(false);\n    }).catch(error => {\n      console.warn('signUp error >>>', error);\n      setError({\n        code: error.code,\n        message: error.message\n      });\n      setUser(false);\n    }).finally(() => setLoading(false));\n  }\n\n  function signout() {\n    setLoading(true);\n    signOut(auth).then(() => {\n      console.log('signOut success >>>', true);\n      setUser(false);\n      setError(false);\n    }).catch(error => {\n      console.warn('signOut error >>>', error);\n      setError({\n        code: error.code,\n        message: error.message\n      });\n    }).finally(() => setLoading(false));\n  }\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, user => {\n      if (loading) {\n        setLoading(false);\n      }\n\n      if (user) {\n        return getDocument;\n      } else {\n        console.log('AuthStateChanged >>>', false);\n        setUser(false);\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n  return {\n    user,\n    error,\n    loading,\n    signin,\n    signup,\n    signout\n  };\n}\n\n_s3(useProvideAuth, \"YAQkXPgA01wPcbjFJGujPkAo1hE=\", false, function () {\n  return [useDB, useDB];\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["C:/Users/Sergey/Desktop/Messenger/src/hooks/useAuth.js"],"names":["useState","useEffect","useContext","createContext","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","auth","useDB","getDB","AuthContext","AuthProvider","children","authData","useProvideAuth","useAuth","user","setUser","error","setError","loading","setLoading","setDocument","getDocument","signin","email","password","then","userCredential","console","log","catch","warn","code","message","finally","signup","nickname","newUser","createdAt","Date","now","friends","uid","signout","unsubscribe"],"mappings":"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","sourcesContent":["import { useState, useEffect, useContext, createContext } from 'react';\nimport {\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  signOut,\n  onAuthStateChanged,\n} from 'firebase/auth';\nimport { auth } from '../firebase';\nimport { useDB } from './useDB';\nimport { getDB } from './useDB';\n\nconst AuthContext = createContext();\n\nexport function AuthProvider({ children }) {\n  const authData = useProvideAuth();\n  return (\n    <AuthContext.Provider value={authData}>{children}</AuthContext.Provider>\n  );\n}\n\nexport const useAuth = () => {\n  return useContext(AuthContext);\n};\n\nfunction useProvideAuth() {\n  const [user, setUser] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const { setDocument } = useDB();\n  const { getDocument } = useDB();\n  \n\n  function signin(email, password) {\n    setLoading(true);\n    signInWithEmailAndPassword(auth, email, password)\n      .then((userCredential) => {\n        console.log('signIn userCredential >>>', userCredential);\n        setUser(userCredential.user);\n        setError(false);\n      })\n      .catch((error) => {\n        console.warn('signIn error >>>', error);\n        setError({ code: error.code, message: error.message });\n        setUser(false);\n      })\n      .finally(() => setLoading(false));\n  }\n  function signup({ email, password, nickname }) {\n    setLoading(true);\n    createUserWithEmailAndPassword(auth, email, password)\n      .then((userCredential) => {\n        console.log('signUp userCredential >>>', userCredential);\n        const newUser = {\n          nickname,\n          email,\n          createdAt: Date.now(),\n          friends: [],\n          uid: userCredential.user.uid,\n        };\n        setDocument('users', newUser, userCredential.user.uid);\n        setUser(newUser);\n        setError(false);\n      })\n      .catch((error) => {\n        console.warn('signUp error >>>', error);\n        setError({ code: error.code, message: error.message });\n        setUser(false);\n      })\n      .finally(() => setLoading(false));\n  }\n  function signout() {\n    setLoading(true);\n    signOut(auth)\n      .then(() => {\n        console.log('signOut success >>>', true);\n        setUser(false);\n        setError(false);\n      })\n      .catch((error) => {\n        console.warn('signOut error >>>', error);\n        setError({ code: error.code, message: error.message });\n      })\n      .finally(() => setLoading(false));\n  }\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      if (loading) {\n        setLoading(false);\n      }\n      if (user) {\n        return(getDocument)\n      } else {\n        console.log('AuthStateChanged >>>', false);\n        setUser(false);\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n\n  return {\n    user,\n    error,\n    loading,\n    signin,\n    signup,\n    signout,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}